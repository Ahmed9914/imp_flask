{% extends 'base.html' %}
{% from 'imp_flask_mod_helpers.html' import render_mod_as_equation %}
{% from 'imp_flask_general_helpers.html' import format_currency %}

{% block container %}

<form class="form-horizontal">
<div class="col-lg-6">
<div class="well bs-component">
  <fieldset>
    {% if mod -%}
    <legend>Edit Mod</legend>
    {%- else -%}
    <legend>Add Mod</legend>
    {%- endif %}
    <div class="form-group">
      <label for="name" class="col-lg-3 control-label">Name</label>
      <div class="col-lg-9">
        <input type="text" class="form-control" id="name" placeholder="Name" value="{% if relation %}{{ relation.name }}{% endif %}">
      </div>
    </div>
    <div class="form-group">
      <label for="group" class="col-lg-3 control-label">Tag</label>
      <div class="col-lg-9">
        <input type="text" class="form-control" id="email" placeholder="Email" value="{% if relation %}{{ relation.email }}{% endif %}">
      </div>
    </div>
    <div class="form-group">
      <label for="description" class="col-lg-3 control-label">Description</label>
      <div class="col-lg-9">
        <textarea class="form-control" rows="3" id="description"></textarea>
      </div>
    </div>
 
    <div class="form-group">
      <label for="inputOther" class="col-lg-3 control-label">Behaviour</label>
      <div class="col-lg-9">
        <div id="inputOther" class="checkbox">
          <label class="col-md-12">
            <input id="send_transaction" type="checkbox" {% if relation and relation.send_transaction %}checked{% endif %}> Send transactions
          </label>
          <label class="col-md-12">
            <input id="send_transaction_updates" type="checkbox" {% if relation and relation.send_transaction_updates %}checked{% endif %}> Send transaction updates
          </label>
            <label class="col-md-12">
            <input id="send_budget_warnings" type="checkbox" {% if relation and relation.send_budget_warnings %}checked{% endif %}> Send budget warnings
          </label>
        </div>
      </div>
    </div>
      <div class="form-group">
      <label for="value" class="col-lg-3 control-label">Budget</label>
      <div class="col-lg-9">
        <div id="valwrap" class="input-group">
          <span class="input-group-addon"><span class="glyphicon glyphicon-euro" aria-hidden="true"></span></span>
          <input id="budget" type="text" class="form-control" placeholder="Budget" value="{% if relation %}{{ format_currency(relation.budget) }}{% endif %}">
        </div>
      </div>
    </div>  
      <div class="form-group">
      <div class="col-lg-9 col-lg-offset-3">
        <button type="button" onclick="submit_relation();" class="btn btn-success">Submit</button>
        <a class="btn btn-default" href="{{ url_for('.index') }}">Back to all</a>
      </div>
    </div>
  </fieldset>
</div>
</div>
</form>

{% endblock %}

{% block scripts %}
{{ super() }}
<script type="text/javascript">
function submit_relation() {  
    var tosubmit = {};
    if (field_validate_money_or_none('#budget')) {
        
        tosubmit.name = $('#name').val();
        tosubmit.email = $('#email').val();
        
        if ($('#budget').val() != "")    
            tosubmit.budget = parseInt(parseFloat($('#budget').val()) * 100.0);

        tosubmit.send_transaction = $("#send_transaction").prop("checked");
        tosubmit.send_transaction_updates = $("#send_transaction_updates").prop("checked");
        tosubmit.send_budget_warnings = $("#send_budget_warnings").prop("checked");
        
        post_object(tosubmit, "/relations");
    }
}
</script>
{% endblock %}
